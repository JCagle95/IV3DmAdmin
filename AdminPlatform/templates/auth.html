<!--
=========================================================
* Now UI Design System PRO - v2.1.0
=========================================================

* Product Page:  https://www.creative-tim.com/product/now-ui-design-system-pro
* Copyright 2021 Creative Tim (https://www.creative-tim.com)

Coded by www.creative-tim.com

 =========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->

{% load static %}

<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="../assets/img/favicon.png">
  <title>
    IV3Dm Admin Platform
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700,200|Open+Sans+Condensed:700" rel="stylesheet">
  <!-- Nucleo Icons -->
  <link href="{% static 'css/nucleo-icons.css' %}" rel="stylesheet" />
  <!-- Project Script -->
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <!-- CSS Files -->
  <link href="{% static 'css/now-design-system-pro.css' %}?v=2.1.0" rel="stylesheet" />

  <script src="https://cdn.jsdelivr.net/npm/opus-media-recorder@latest/OpusMediaRecorder.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/opus-media-recorder@latest/encoderWorker.umd.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.8.3.min.js"></script>

</head>

<body class="reset-basic">
  <!-- Navbar Transparent -->
  <nav class="navbar navbar-expand-lg position-absolute top-0 z-index-3 w-100 shadow-none my-3  navbar-transparent ">
    <div class="container">
      <a class="navbar-brand  text-white " href="" rel="tooltip" title="Cough Meter (Demo)" data-placement="bottom">
        IV3Dm Admin Platform
      </a>
    </div>
  </nav>
  <!-- End Navbar -->
  <section>
    <div class="page-header min-vh-100" style="background-image: url('https://images.pexels.com/photos/620337/pexels-photo-620337.jpeg?cs=srgb&dl=pexels-tobi-620337.jpg&fm=jpg');">
      <span class="mask bg-gradient-dark opacity-4"></span>
      <div class="container">
        <div class="row">
          <div class="col-lg-6 col-md-9 mx-auto">
            <div class="card">
              <div class="card-body px-lg-5 py-lg-5 text-center">
                <div class="info mb-4">
                  <div class="icon icon-shape icon-xl rounded-circle bg-gradient-primary shadow text-center py-3 mx-auto">
                    <i class="ni ni-atom opacity-10 mt-2"></i>
                  </div>
                </div>
                <h2>2FA Security</h2>
                <p class="mb-4">Enter 6-digits code from your athenticatior app.</p>
                <form>
                  <div class="row mb-4">
                    <div class="col-lg-2 col-md-2 col-2 ps-0 ps-md-2">
                      <input id="inputVerification1" type="text" class="form-control text-lg text-center" maxlength="1" aria-label="2fa" onkeyup="moveCursor(this, event, 1);">
                    </div>
                    <div class="col-lg-2 col-md-2 col-2 ps-0 ps-md-2">
                      <input id="inputVerification2" type="text" class="form-control text-lg text-center" maxlength="1" aria-label="2fa" onkeyup="moveCursor(this, event, 2);">
                    </div>
                    <div class="col-lg-2 col-md-2 col-2 ps-0 ps-md-2">
                      <input id="inputVerification3" type="text" class="form-control text-lg text-center" maxlength="1" aria-label="2fa" onkeyup="moveCursor(this, event, 3);">
                    </div>
                    <div class="col-lg-2 col-md-2 col-2 pe-0 pe-md-2">
                      <input id="inputVerification4" type="text" class="form-control text-lg text-center" maxlength="1" aria-label="2fa" onkeyup="moveCursor(this, event, 4);">
                    </div>
                    <div class="col-lg-2 col-md-2 col-2 pe-0 pe-md-2">
                      <input id="inputVerification5" type="text" class="form-control text-lg text-center" maxlength="1" aria-label="2fa" onkeyup="moveCursor(this, event, 5);">
                    </div>
                    <div class="col-lg-2 col-md-2 col-2 pe-0 pe-md-2">
                      <input id="inputVerification6" type="text" class="form-control text-lg text-center" maxlength="1" aria-label="2fa" onkeyup="moveCursor(this, event, 6);">
                    </div>
                  </div>
                  <div class="text-center">
                    <button type="button" class="btn bg-gradient-primary my-4">Verify</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!--   Core JS Files   -->

  <script src="{% static 'js/core/jquery.min.js' %}"></script>
  <script src="{% static 'js/core/popper.min.js' %}"></script>
  <script src="{% static 'js/core/bootstrap.min.js' %}"></script>
  <script src="{% static 'js/plugins/perfect-scrollbar.min.js' %}"></script>
  <!-- Control Center for Black Ui Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="{% static 'js/now-design-system-pro.min.js' %}" type="text/javascript"></script>
  <!-- Bootstrap Switches  -->
  <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>

  <script src="{% static 'js/plugins/typedjs.js' %}"></script>
  <script src="{% static 'js/plugins/parallax.min.js' %}"></script>
  <script src="{% static 'js/plugins/nouislider.min.js' %}"></script>
  <script src="{% static 'js/plugins/glidejs.min.js' %}"></script>
  <script src="{% static 'js/plugins/anime.min.js' %}"></script>
  <script src="{% static 'js/plugins/sweetalert.min.js' %}"></script>

  <script>
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    const csrftoken = getCookie('csrftoken');

    function moveCursor(el, event, id) {
      if (event.key != "Backspace") {
        if (el.value.length > 0) el.value = event.key;
        if (id == 1) {
          document.getElementById("inputVerification2").focus()
        } else if (id == 2) {
          document.getElementById("inputVerification3").focus()
        } else if (id == 3) {
          document.getElementById("inputVerification4").focus()
        } else if (id == 4) {
          document.getElementById("inputVerification5").focus()
        } else if (id == 5) {
          document.getElementById("inputVerification6").focus()
        } else if (id == 6) {
          submitVerification();
        }
      }
    }

    async function submitVerification() {
      let formData = new FormData();
      formData.append("verificationCode", document.getElementById("inputVerification1").value + document.getElementById("inputVerification2").value + document.getElementById("inputVerification3").value + document.getElementById("inputVerification4").value + document.getElementById("inputVerification5").value + document.getElementById("inputVerification6").value);
      const response = await fetch(window.location.origin + "/auth", {method: "POST", body: formData, headers: { 'X-CSRFToken': csrftoken },})
      if (response.status == 200) {
        window.location.reload();
      }
    }

  </script>

</body>

</html>
